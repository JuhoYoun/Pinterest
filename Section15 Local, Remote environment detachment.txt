Database detachment with MariaDB

지금은 db가 장고 컨테이너 안의 sqlite3 파일로 구동되지만 마리아 db 컨테이너를 따로 만들어 관리하도록하자 그리고 이 마리아 db 컨테이너에 볼륨을 설정해 컨테이너 유무에 상관 없이 데이터가 유지되도록 하자

그런데 이렇게 하면되면 VPS 서버(마리아db)와 내 로컬 서버(sqlite)의 환경이 다르게 된다 다시말해 local environment와 deploy environment가 달라진다 그래서 나중에 이 환경들에 대한 세팅을 분리시키는 작업이 필요하다

일단 mariadb 컨테이너를 만들자

dockerhub
-> https://hub.docker.com/_/mariadb

Starting a MariaDB instance with the latest version is simple:

$ docker run --detach --name some-mariadb --env MARIADB_USER=example-user --env MARIADB_PASSWORD=my_cool_secret --env MARIADB_ROOT_PASSWORD=my-secret-pw  mariadb:latest

이렇게 써 있다 여기 보면 env 즉 환경 변수를 설정해 줘야한다고 한다 MARIADB_USER, MARIADB_PASSWORD, MARIADB_ROOT_PASSWORD 이 변수들의 값을 설정해줘야한다

portainer로 가서 바로 컨테이너를 만들어주자 name은 mariadb라고 해주고 image에 mariadb:10.9 라고 해주자 버전을 명시하지 않으면 가장 최신것이 설치된다 그리고 Env로 가서 위의 세 변수들을 설정해주자
강의에서는 여기까지 하고 일단 컨테이너를 만들어 구동되는지 확인하였다

일단 local environmnet 설정과 deploy environment 설정을 분리 하는 작업을 한후 컨테이너를 연동하는 작업을 진행하자
소스에서 프로젝트 앱 내부의 settings.py 의 설정들을 나누어여한다 프로젝트앱 내부에 새로운 파이썬 패키지를 만들것이다 settings 라는 이름으로 만들자 그리고 settings.py를 settings 디렉토리 안에 넣고 base.py라고 바꾸자
그리고 settings 디렉토리 안에 local.py와 deploy.py를 만든다

